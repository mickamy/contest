// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Code generated by protoc-gen-connect-go. DO NOT EDIT.
//
// Source: google/iam/v1/iam_policy.proto

package iamv1connect

import (
	connect "connectrpc.com/connect"
	context "context"
	errors "errors"
	v1 "github.com/mickamy/contest/example/gen/google/iam/v1"
	http "net/http"
	strings "strings"
)

// This is a compile-time assertion to ensure that this generated file and the connect package are
// compatible. If you get a compiler error that this constant is not defined, this code was
// generated with a version of connect newer than the one compiled into your binary. You can fix the
// problem by either regenerating this code with an older version of connect or updating the connect
// version compiled into your binary.
const _ = connect.IsAtLeastVersion1_13_0

const (
	// IAMPolicyName is the fully-qualified name of the IAMPolicy service.
	IAMPolicyName = "google.iam.v1.IAMPolicy"
)

// These constants are the fully-qualified names of the RPCs defined in this package. They're
// exposed at runtime as Spec.Procedure and as the final two segments of the HTTP route.
//
// Note that these are different from the fully-qualified method names used by
// google.golang.org/protobuf/reflect/protoreflect. To convert from these constants to
// reflection-formatted method names, remove the leading slash and convert the remaining slash to a
// period.
const (
	// IAMPolicySetIamPolicyProcedure is the fully-qualified name of the IAMPolicy's SetIamPolicy RPC.
	IAMPolicySetIamPolicyProcedure = "/google.iam.v1.IAMPolicy/SetIamPolicy"
	// IAMPolicyGetIamPolicyProcedure is the fully-qualified name of the IAMPolicy's GetIamPolicy RPC.
	IAMPolicyGetIamPolicyProcedure = "/google.iam.v1.IAMPolicy/GetIamPolicy"
	// IAMPolicyTestIamPermissionsProcedure is the fully-qualified name of the IAMPolicy's
	// TestIamPermissions RPC.
	IAMPolicyTestIamPermissionsProcedure = "/google.iam.v1.IAMPolicy/TestIamPermissions"
)

// IAMPolicyClient is a client for the google.iam.v1.IAMPolicy service.
type IAMPolicyClient interface {
	// Sets the access control policy on the specified resource. Replaces any
	// existing policy.
	//
	// Can return `NOT_FOUND`, `INVALID_ARGUMENT`, and `PERMISSION_DENIED` errors.
	SetIamPolicy(context.Context, *connect.Request[v1.SetIamPolicyRequest]) (*connect.Response[v1.Policy], error)
	// Gets the access control policy for a resource.
	// Returns an empty policy if the resource exists and does not have a policy
	// set.
	GetIamPolicy(context.Context, *connect.Request[v1.GetIamPolicyRequest]) (*connect.Response[v1.Policy], error)
	// Returns permissions that a caller has on the specified resource.
	// If the resource does not exist, this will return an empty set of
	// permissions, not a `NOT_FOUND` error.
	//
	// Note: This operation is designed to be used for building permission-aware
	// UIs and command-line tools, not for authorization checking. This operation
	// may "fail open" without warning.
	TestIamPermissions(context.Context, *connect.Request[v1.TestIamPermissionsRequest]) (*connect.Response[v1.TestIamPermissionsResponse], error)
}

// NewIAMPolicyClient constructs a client for the google.iam.v1.IAMPolicy service. By default, it
// uses the Connect protocol with the binary Protobuf Codec, asks for gzipped responses, and sends
// uncompressed requests. To use the gRPC or gRPC-Web protocols, supply the connect.WithGRPC() or
// connect.WithGRPCWeb() options.
//
// The URL supplied here should be the base URL for the Connect or gRPC server (for example,
// http://api.acme.com or https://acme.com/grpc).
func NewIAMPolicyClient(httpClient connect.HTTPClient, baseURL string, opts ...connect.ClientOption) IAMPolicyClient {
	baseURL = strings.TrimRight(baseURL, "/")
	iAMPolicyMethods := v1.File_google_iam_v1_iam_policy_proto.Services().ByName("IAMPolicy").Methods()
	return &iAMPolicyClient{
		setIamPolicy: connect.NewClient[v1.SetIamPolicyRequest, v1.Policy](
			httpClient,
			baseURL+IAMPolicySetIamPolicyProcedure,
			connect.WithSchema(iAMPolicyMethods.ByName("SetIamPolicy")),
			connect.WithClientOptions(opts...),
		),
		getIamPolicy: connect.NewClient[v1.GetIamPolicyRequest, v1.Policy](
			httpClient,
			baseURL+IAMPolicyGetIamPolicyProcedure,
			connect.WithSchema(iAMPolicyMethods.ByName("GetIamPolicy")),
			connect.WithClientOptions(opts...),
		),
		testIamPermissions: connect.NewClient[v1.TestIamPermissionsRequest, v1.TestIamPermissionsResponse](
			httpClient,
			baseURL+IAMPolicyTestIamPermissionsProcedure,
			connect.WithSchema(iAMPolicyMethods.ByName("TestIamPermissions")),
			connect.WithClientOptions(opts...),
		),
	}
}

// iAMPolicyClient implements IAMPolicyClient.
type iAMPolicyClient struct {
	setIamPolicy       *connect.Client[v1.SetIamPolicyRequest, v1.Policy]
	getIamPolicy       *connect.Client[v1.GetIamPolicyRequest, v1.Policy]
	testIamPermissions *connect.Client[v1.TestIamPermissionsRequest, v1.TestIamPermissionsResponse]
}

// SetIamPolicy calls google.iam.v1.IAMPolicy.SetIamPolicy.
func (c *iAMPolicyClient) SetIamPolicy(ctx context.Context, req *connect.Request[v1.SetIamPolicyRequest]) (*connect.Response[v1.Policy], error) {
	return c.setIamPolicy.CallUnary(ctx, req)
}

// GetIamPolicy calls google.iam.v1.IAMPolicy.GetIamPolicy.
func (c *iAMPolicyClient) GetIamPolicy(ctx context.Context, req *connect.Request[v1.GetIamPolicyRequest]) (*connect.Response[v1.Policy], error) {
	return c.getIamPolicy.CallUnary(ctx, req)
}

// TestIamPermissions calls google.iam.v1.IAMPolicy.TestIamPermissions.
func (c *iAMPolicyClient) TestIamPermissions(ctx context.Context, req *connect.Request[v1.TestIamPermissionsRequest]) (*connect.Response[v1.TestIamPermissionsResponse], error) {
	return c.testIamPermissions.CallUnary(ctx, req)
}

// IAMPolicyHandler is an implementation of the google.iam.v1.IAMPolicy service.
type IAMPolicyHandler interface {
	// Sets the access control policy on the specified resource. Replaces any
	// existing policy.
	//
	// Can return `NOT_FOUND`, `INVALID_ARGUMENT`, and `PERMISSION_DENIED` errors.
	SetIamPolicy(context.Context, *connect.Request[v1.SetIamPolicyRequest]) (*connect.Response[v1.Policy], error)
	// Gets the access control policy for a resource.
	// Returns an empty policy if the resource exists and does not have a policy
	// set.
	GetIamPolicy(context.Context, *connect.Request[v1.GetIamPolicyRequest]) (*connect.Response[v1.Policy], error)
	// Returns permissions that a caller has on the specified resource.
	// If the resource does not exist, this will return an empty set of
	// permissions, not a `NOT_FOUND` error.
	//
	// Note: This operation is designed to be used for building permission-aware
	// UIs and command-line tools, not for authorization checking. This operation
	// may "fail open" without warning.
	TestIamPermissions(context.Context, *connect.Request[v1.TestIamPermissionsRequest]) (*connect.Response[v1.TestIamPermissionsResponse], error)
}

// NewIAMPolicyHandler builds an HTTP handler from the service implementation. It returns the path
// on which to mount the handler and the handler itself.
//
// By default, handlers support the Connect, gRPC, and gRPC-Web protocols with the binary Protobuf
// and JSON codecs. They also support gzip compression.
func NewIAMPolicyHandler(svc IAMPolicyHandler, opts ...connect.HandlerOption) (string, http.Handler) {
	iAMPolicyMethods := v1.File_google_iam_v1_iam_policy_proto.Services().ByName("IAMPolicy").Methods()
	iAMPolicySetIamPolicyHandler := connect.NewUnaryHandler(
		IAMPolicySetIamPolicyProcedure,
		svc.SetIamPolicy,
		connect.WithSchema(iAMPolicyMethods.ByName("SetIamPolicy")),
		connect.WithHandlerOptions(opts...),
	)
	iAMPolicyGetIamPolicyHandler := connect.NewUnaryHandler(
		IAMPolicyGetIamPolicyProcedure,
		svc.GetIamPolicy,
		connect.WithSchema(iAMPolicyMethods.ByName("GetIamPolicy")),
		connect.WithHandlerOptions(opts...),
	)
	iAMPolicyTestIamPermissionsHandler := connect.NewUnaryHandler(
		IAMPolicyTestIamPermissionsProcedure,
		svc.TestIamPermissions,
		connect.WithSchema(iAMPolicyMethods.ByName("TestIamPermissions")),
		connect.WithHandlerOptions(opts...),
	)
	return "/google.iam.v1.IAMPolicy/", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		switch r.URL.Path {
		case IAMPolicySetIamPolicyProcedure:
			iAMPolicySetIamPolicyHandler.ServeHTTP(w, r)
		case IAMPolicyGetIamPolicyProcedure:
			iAMPolicyGetIamPolicyHandler.ServeHTTP(w, r)
		case IAMPolicyTestIamPermissionsProcedure:
			iAMPolicyTestIamPermissionsHandler.ServeHTTP(w, r)
		default:
			http.NotFound(w, r)
		}
	})
}

// UnimplementedIAMPolicyHandler returns CodeUnimplemented from all methods.
type UnimplementedIAMPolicyHandler struct{}

func (UnimplementedIAMPolicyHandler) SetIamPolicy(context.Context, *connect.Request[v1.SetIamPolicyRequest]) (*connect.Response[v1.Policy], error) {
	return nil, connect.NewError(connect.CodeUnimplemented, errors.New("google.iam.v1.IAMPolicy.SetIamPolicy is not implemented"))
}

func (UnimplementedIAMPolicyHandler) GetIamPolicy(context.Context, *connect.Request[v1.GetIamPolicyRequest]) (*connect.Response[v1.Policy], error) {
	return nil, connect.NewError(connect.CodeUnimplemented, errors.New("google.iam.v1.IAMPolicy.GetIamPolicy is not implemented"))
}

func (UnimplementedIAMPolicyHandler) TestIamPermissions(context.Context, *connect.Request[v1.TestIamPermissionsRequest]) (*connect.Response[v1.TestIamPermissionsResponse], error) {
	return nil, connect.NewError(connect.CodeUnimplemented, errors.New("google.iam.v1.IAMPolicy.TestIamPermissions is not implemented"))
}
